<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>SQL: Pick up the Basic within a day - Criss Wang&#039;s Log Book</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Criss Wang&#039;s Log Book"><meta name="msapplication-TileImage" content="https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Steins_Gate_Lab_Badge.webp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Criss Wang&#039;s Log Book"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="The best way to get the memory back is by looking at the code themselves"><meta property="og:type" content="blog"><meta property="og:title" content="SQL: Pick up the Basic within a day"><meta property="og:url" content="https://criss-wang.github.io/post/blogs/sql-1/"><meta property="og:site_name" content="Criss Wang&#039;s Log Book"><meta property="og:description" content="The best way to get the memory back is by looking at the code themselves"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://criss-wang.github.io/img/og_image.png"><meta property="article:published_time" content="2020-08-15T04:00:00.000Z"><meta property="article:modified_time" content="2022-05-25T04:00:00.000Z"><meta property="article:author" content="Zhenlin Wang"><meta property="article:tag" content="Database System"><meta property="article:tag" content="SQL"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://criss-wang.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://criss-wang.github.io/post/blogs/sql-1/"},"headline":"SQL: Pick up the Basic within a day","image":["https://criss-wang.github.io/img/og_image.png"],"datePublished":"2020-08-15T04:00:00.000Z","dateModified":"2022-05-25T04:00:00.000Z","author":{"@type":"Person","name":"Zhenlin Wang"},"publisher":{"@type":"Organization","name":"Criss Wang's Log Book","logo":{"@type":"ImageObject","url":"https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Steins_Gate_Lab_Badge.webp"}},"description":"The best way to get the memory back is by looking at the code themselves"}</script><link rel="canonical" href="https://criss-wang.github.io/post/blogs/sql-1/"><link rel="icon" href="https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Steins_Gate_Lab_Badge.webp"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto Slab:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Steins_Gate_Lab_Badge.webp" alt="Criss Wang&#039;s Log Book" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" style="font-weight: bold" href="/">Criss&#039;s Time Machine</a><a class="navbar-item" style="font-weight: bold" href="/categories/Blogs">Tech Blogs</a><a class="navbar-item" style="font-weight: bold" href="/categories/Projects">Projects</a><a class="navbar-item" style="font-weight: bold" href="/categories/Anime">Anime</a><a class="navbar-item" style="font-weight: bold" href="/categories/Enlightenment">Enlightenment</a><a class="navbar-item" style="font-weight: bold" href="/publication">Publications</a><a class="navbar-item" style="font-weight: bold" href="/archives">Archives</a><a class="navbar-item" style="font-weight: bold" href="/intro">About Me</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Criss-Wang/"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-4 is-size-5-mobile has-text-weight-normal">SQL: Pick up the Basic within a day</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2020-08-15T04:00:00.000Z" title="2020-08-15T04:00:00.000Z">2020-08-15</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2022-05-25T04:00:00.000Z" title="2022-05-25T04:00:00.000Z">2022-05-25</time></span><span class="level-item"><i class="far fa-folder-open"> </i><a class="link-muted" href="/categories/Blogs/">Blogs</a></span><span class="level-item"><i class="far fa-clock"> </i>20 minutes read (About 2959 words)</span></div></div><div><hr style="background-color:grey"></div><div style="padding-bottom:5px"></div><div class="content"><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>This blog is for people who have learnt SQL at some points of their study (just like me): We can quickly recap on various important concepts in SQL.</p>
<h3 id="Basic-Concepts"><a href="#Basic-Concepts" class="headerlink" title="Basic Concepts"></a>Basic Concepts</h3><ol>
<li><p>Primary key:</p>
<ul>
<li>Always unique for each row of the table, it must be NOT NULL (automatically set when <code>PRIMARY KEY</code> is specified)</li>
<li>Helps to identify each row even when row attributes are the same</li>
<li>A table must have and only have 1 primary key</li>
<li>Types:<ul>
<li>Surrogate key : An artificial key that has no mapping to anything (or business value) in real world.</li>
<li>Natural key: A key that has mapping to real world thing: example: social security number/ NRIC / Passport number</li>
</ul>
</li>
</ul>
</li>
<li><p>composiite key: 2 column entries combined to form a key</p>
<ul>
<li>Motivation: sometimes individuals of 2 entries cannot uniquely identify a row;</li>
</ul>
</li>
<li><p>Foreign key:</p>
<ul>
<li>Stores the primary key of a row in another database table</li>
<li>The foreign key's column name NOT necessary to coincide with the foreign table's primary key column name</li>
<li>A table can have more than 1 foreign key (or no foreign key at all)</li>
</ul>
</li>
<li><p>advance concept:</p>
<ul>
<li><p><strong>Q</strong>: is it possible that TABLE A's foreign key is TABLE B's primary key and TABLE B's foreign key is TABLE A's primary key?</p>
<p><strong>A</strong>: Yes! cyclic dependency is valid in SQL.</p>
<p><strong>Example</strong>: <code>employee</code>'s <code>emp_id</code> is <code>department</code>'s <code>manager_id</code>; <code>department</code>'s <code>branch_id</code> is <code>employee</code>'s <code>department_id</code>.</p>
</li>
<li><p><strong>Q</strong>: is it possible that TABLE A's foreign key relates to itself? </p>
<p><strong>A</strong>: Yes! used to define relationships between rows within a table.</p>
<p><strong>Example</strong>: <code>employee</code>'s <code>super_id</code> refers to a row in <code>employee</code>'s table.</p>
</li>
</ul>
</li>
<li><p>Data Types:</p>
<ol>
<li><kbd>INT</kbd>: – Whole number</li>
<li><kbd>DECIMAL(M,N)</kbd>: 	– Decimal numbers - exact value, M digits, N after decimal point</li>
<li><kbd>VARCHAR(K)</kbd>:		– Sring of text of length K</li>
<li><kbd>BLOB</kbd>:			– Binary Large Object, stores large data</li>
<li><kbd>DATE</kbd>:				– 'YYYY-MM-DD'</li>
<li><kbd>TIMESTAMP</kbd>		– 'YYYY-MM-DD HH:MM:SS'</li>
</ol>
</li>
<li><p>Difference between DROP and DELETE:</p>
<table>
<thead>
<tr>
<th>DELETE</th>
<th>DROP</th>
</tr>
</thead>
<tbody><tr>
<td>Data Manipulation Language command</td>
<td>Data Definition Language Command</td>
</tr>
<tr>
<td>To remove tuples from a table</td>
<td>To remove entire schema, table, domain or constraints from the database</td>
</tr>
</tbody></table>
</li>
</ol>
<h3 id="Basic-Operations"><a href="#Basic-Operations" class="headerlink" title="Basic Operations"></a>Basic Operations</h3><ol start="0">
<li><p>Create Database</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE July_05;</span><br><span class="line">USE July_05;</span><br></pre></td></tr></table></figure>
<p>  Logical Query Processing (IMPT)</p>
<ul>
<li>Step 1. <kbd>FROM (includes JOINS)</kbd> <br></li>
<li>Step 2. <kbd>WHERE</kbd> <br></li>
<li>Step 3. <kbd>GROUP BY</kbd> <br></li>
<li>Step 4. <kbd>HAVING</kbd> <br></li>
<li>Step 5. <kbd>SELECT</kbd> <br></li>
<li>Step 6. <kbd>ORDER BY</kbd> <br><br>  <strong>CAUTION about column ordering</strong>: columns evaluated at later steps must be created in earlier steps</li>
</ul>
</li>
<li><p>Table Opeartions</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">    student_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    student_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    major <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">    thr_id <span class="type">INT</span>,</span><br><span class="line">    <span class="comment">-- can also remove the PRIMARY KEY above and add a line below</span></span><br><span class="line">    <span class="comment">-- PRIMARY KEY(student_id)</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY(thr_id) <span class="keyword">REFERENCES</span> teacher(emp_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- Show all columns properties using the DESCRIBE keyword</span></span><br><span class="line"><span class="keyword">DESCRIBE</span> student;</span><br><span class="line"><span class="comment">-- Name          Null       Type</span></span><br><span class="line"><span class="comment">-- student_id               INT</span></span><br><span class="line"><span class="comment">-- name                     VARCHAR(50)</span></span><br><span class="line"><span class="comment">-- major                    VARCHAR(20)</span></span><br></pre></td></tr></table></figure>
<p>Delete or modify a table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> student;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> gpa <span class="type">DECIMAL</span>(<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> gpa;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student MODIFY <span class="keyword">COLUMN</span> major TINYINT(<span class="number">1</span>) UNSIGNED;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_id <span class="keyword">PRIMARY</span> KEY (student_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_id <span class="keyword">FOREIGN</span> KEY (thr_id) <span class="keyword">REFERENCES</span> teacher(emp_id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>Row Insertion</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Two ways of insertion</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student <span class="keyword">VALUES</span>(<span class="number">2</span>, <span class="string">'Kate'</span>, <span class="string">'Sociology'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(student_id, name) <span class="keyword">VALUES</span>(<span class="number">3</span>, <span class="string">'Claire'</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>More properties of column</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">    student_id <span class="type">INT</span> AUTO_INCREMENT, <span class="comment">-- id increase automaically if not specified</span></span><br><span class="line">	student_id2 <span class="type">INT</span> <span class="keyword">IDENTITY</span>(<span class="number">1</span>, <span class="number">1</span>) <span class="comment">-- similar to AUTO_INCREMENT except</span></span><br><span class="line">								   <span class="comment">-- IDENTITY(seed, increment) enables one to self define the starting value (seed) and the increment amount (increment)</span></span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">-- name value cannot be empty</span></span><br><span class="line">    major <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span>, <span class="comment">-- each row's major value must be unique across the table</span></span><br><span class="line">	info <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="string">'undecided'</span>, <span class="comment">--info has 'undecided' as default value</span></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(student_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li><p>Update the table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Modify the content</span></span><br><span class="line"><span class="keyword">UPDATE</span> student</span><br><span class="line"><span class="keyword">SET</span> major <span class="operator">=</span> <span class="string">'Biochemistry'</span>, name <span class="operator">=</span> <span class="string">'What'</span></span><br><span class="line"><span class="keyword">WHERE</span> major <span class="operator">=</span> <span class="string">'Biology'</span> <span class="keyword">or</span> major <span class="operator">=</span> <span class="string">'Chemistry'</span>; <span class="comment">-- if no WHERE is applied, the set applies to all</span></span><br><span class="line"><span class="comment">-- Delete entries</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> student_id <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure></li>
<li><p><kbd>SELECT</kbd> keyword</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- partial selection</span></span><br><span class="line"><span class="keyword">SELECT</span> student.name, student.major</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> major, name <span class="keyword">DESC</span>; <span class="comment">-- by default ascending order, DESC change to descending</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- or both major and name descending by </span></span><br><span class="line"><span class="keyword">SELECT</span> name, major </span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> major <span class="keyword">DESC</span>, student_id <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line"><span class="operator">-</span> other optional selection technique</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHERE</span> major <span class="operator">=</span> <span class="string">'chemistry'</span> <span class="keyword">OR</span> major <span class="operator">=</span> <span class="string">'Bio'</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHERE</span> name <span class="keyword">IN</span> (<span class="string">'kate'</span>, <span class="string">'Claire'</span>, <span class="string">'Jack'</span>); <span class="comment">-- the use of IN keyword</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHERE</span> birth_day <span class="keyword">BETWEEN</span> <span class="string">'1970-01-01'</span> <span class="keyword">AND</span> <span class="string">'1975-01-01'</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHERE</span> (birth_day <span class="operator">&gt;=</span> <span class="string">'1970-01-01'</span> <span class="keyword">AND</span> sex <span class="operator">=</span> <span class="string">'F'</span>) <span class="keyword">OR</span> salary <span class="operator">&gt;</span> <span class="number">80000</span>;</span><br><span class="line">...</span><br><span class="line">LIMIT <span class="number">2</span> <span class="keyword">OFFSET</span> <span class="number">1</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> TOP(<span class="number">100</span>) <span class="comment">-- select the 100 rows in the front</span></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">INTO</span> samples <span class="comment">-- select those columns into the "sample" table</span></span><br></pre></td></tr></table></figure></li>
<li><p>comparison keyword</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span>, <span class="operator">&gt;</span> , <span class="operator">&lt;=</span>, <span class="operator">&gt;=</span>, <span class="operator">=</span>, <span class="operator">&lt;&gt;</span> (means <span class="keyword">not</span> equal <span class="keyword">to</span>), <span class="keyword">AND</span>, <span class="keyword">OR</span>, <span class="keyword">ANY</span>, <span class="keyword">ALL</span></span><br></pre></td></tr></table></figure></li>
<li><p>Functions to call</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(sex), sex</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> sex <span class="operator">=</span> <span class="string">'F'</span> <span class="keyword">AND</span> birth_date <span class="operator">&gt;</span> <span class="string">'1971-01-01'</span>;</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sex;</span><br></pre></td></tr></table></figure></li>
<li><p>Wildcard</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- It is often used to find the string containing certain characters;</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> client</span><br><span class="line"><span class="keyword">WHERE</span> client_name <span class="keyword">LIKE</span> <span class="string">'%LLC'</span>;</span><br></pre></td></tr></table></figure>
<ol start="9">
<li><kbd>UNION</kbd></li>
</ol>
<ul>
<li>Motivation: row combine (fixed columns)</li>
<li>Used to combine the multiple select statement into 1;</li>
<li>Vertical join (add rows of the latter <code>SELECT</code> below the rows of former <code>SELECT</code>)</li>
<li><strong>Warning</strong>: each entry within the same column must have the same data-type<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> client.client_name <span class="keyword">AS</span> Non_Employee_Entities, client.branch_id <span class="keyword">AS</span> Branch_ID</span><br><span class="line"><span class="comment">-- here the renaming using AS is very important to make the unioned row's column more logical</span></span><br><span class="line"><span class="comment">-- e.g the client.branch_id and branch_supplier.branch_id unioned to be Branch_ID and branch_id separately in the table returned</span></span><br><span class="line"><span class="keyword">FROM</span> client</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> branch_supplier.supplier_name, branch_supplier.branch_id</span><br><span class="line"><span class="keyword">FROM</span> branch_supplier;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span></span><br><span class="line">(</span><br><span class="line">    (<span class="keyword">SELECT</span> CITY, LENGTH(CITY)</span><br><span class="line">    <span class="keyword">FROM</span> STATION</span><br><span class="line">    <span class="keyword">WHERE</span> LENGTH(CITY) <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(LENGTH(CITY)) <span class="keyword">FROM</span> STATION)</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> CITY)</span><br><span class="line">    <span class="keyword">UNION</span></span><br><span class="line">    (<span class="keyword">SELECT</span> CITY, LENGTH(CITY)</span><br><span class="line">    <span class="keyword">FROM</span> STATION    </span><br><span class="line">    <span class="keyword">WHERE</span> LENGTH(CITY) <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(LENGTH(CITY)) <span class="keyword">FROM</span> STATION)</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> CITY)</span><br><span class="line">) <span class="keyword">AS</span> K <span class="comment">-- note the use of AS is MUST included</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> CITY</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="10">
<li><kbd>JOIN</kbd></li>
</ol>
<ul>
<li>Motivation: column combine (fixed row)</li>
<li>The second table is used as an auxilary table for additional column entries in the first table<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee.emp_id, employee.first_name, branch.branch_name</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">JOIN</span> branch    <span class="comment">-- LEFT JOIN, RIGHT JOIN</span></span><br><span class="line"><span class="keyword">ON</span> employee.emp_id <span class="operator">=</span> branch.mgr_id;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span></span><br><span class="line">(</span><br><span class="line">	(<span class="keyword">SELECT</span> </span><br><span class="line">		<span class="operator">*</span></span><br><span class="line">	 <span class="keyword">FROM</span> STATION <span class="keyword">AS</span> P</span><br><span class="line">	 <span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(P.CITY) <span class="keyword">DESC</span></span><br><span class="line">	) <span class="keyword">AS</span> A</span><br><span class="line">	 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">	 (<span class="keyword">SELECT</span> </span><br><span class="line">		<span class="operator">*</span></span><br><span class="line">	  <span class="keyword">FROM</span> STATION <span class="keyword">AS</span> K</span><br><span class="line">	  <span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(K.CITY) <span class="keyword">DESC</span></span><br><span class="line">	) <span class="keyword">AS</span> B</span><br><span class="line">	<span class="keyword">ON</span> A.ID <span class="operator">=</span> B.ID</span><br><span class="line">)  <span class="comment">-- here should not have AS </span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> A.CITY <span class="comment">-- Must specify A or ambiguous warning</span></span><br></pre></td></tr></table></figure>
Different types of join:<ul>
<li><kbd>INNER JOIN</kbd>: the usual type of JOIN;<br>Only those rows that match the ON criteria in both tables will be included and joined</li>
<li><kbd>LEFT JOIN</kbd>:<br>All those rows in the left table are included but rows in the right table are included only when they match the <code>ON</code> criteria</li>
<li><kbd>RIGHT JOIN</kbd>:<br>the symmetric idea with <kbd>LEFT JOIN</kbd></li>
<li><kbd>OUTER JOIN</kbd>:<br>All the rows in both tables are included (empty columns in the resultant table rows are treated with NULL)</li>
</ul>
</li>
</ul>
<ol start="11">
<li>Nested query<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee.first_name, employee.last_name</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> employee.emp_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> works_with.emp_id</span><br><span class="line">                          <span class="keyword">FROM</span> works_with</span><br><span class="line">                          <span class="keyword">WHERE</span> works_with.total_sales <span class="operator">&gt;</span> <span class="number">50000</span>);</span><br></pre></td></tr></table></figure></li>
<li>ON DELETE<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="comment">-- set the foreign key to null if the primary key which the foreign key refers to gets deleted</span></span><br><span class="line"><span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="comment">-- delete the entire row if the primary key gets deleted, especially important if set null cannot be done (i.e the foreign key cannot be set to null)</span></span><br></pre></td></tr></table></figure></li>
<li>Trigger test<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> trigger_test (</span><br><span class="line">    message <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- the following code needs to be manually typed in mySQL code</span></span><br><span class="line">DELIMITER $$ <span class="comment">-- change the delimiter to $$</span></span><br><span class="line"><span class="keyword">CREATE</span></span><br><span class="line">    <span class="keyword">TRIGGER</span> my_trigger BEFORE <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> employee</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> trigger_test <span class="keyword">VALUES</span>(<span class="string">'added new employee'</span>); <span class="comment">-- note the use of ; delimiter here</span></span><br><span class="line">    <span class="keyword">END</span>$$ <span class="comment">-- we need to use the $$ as delimiter which is declared in line 168</span></span><br><span class="line">DELIMITER ; <span class="comment">-- change the delimiter back to ;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Conditional trigger_test</span></span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span></span><br><span class="line">    <span class="keyword">TRIGGER</span> my_trigger BEFORE <span class="keyword">INSERT</span> <span class="comment">-- can also be UPDATE, DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> employee</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="keyword">BEGIN</span></span><br><span class="line">        IF NEW.sex <span class="operator">=</span> <span class="string">'M'</span> <span class="keyword">THEN</span></span><br><span class="line">              <span class="keyword">INSERT</span> <span class="keyword">INTO</span> trigger_test <span class="keyword">VALUES</span>(<span class="string">'added male employee'</span>);</span><br><span class="line">        ELSEIF NEW.sex <span class="operator">=</span> <span class="string">'F'</span> <span class="keyword">THEN</span></span><br><span class="line">              <span class="keyword">INSERT</span> <span class="keyword">INTO</span> trigger_test <span class="keyword">VALUES</span>(<span class="string">'added female'</span>);</span><br><span class="line">        <span class="keyword">ELSE</span></span><br><span class="line">              <span class="keyword">INSERT</span> <span class="keyword">INTO</span> trigger_test <span class="keyword">VALUES</span>(<span class="string">'added other employee'</span>);</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="comment">-- possible to drop the trigger case (done in client terminal):</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> my_trigger</span><br></pre></td></tr></table></figure></li>
<li>CTE: Common Table Expression<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> Number <span class="comment">-- here Number is the name of the CTE, can be anything </span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"> CustomerId</span><br><span class="line"> , <span class="built_in">NTILE</span>(<span class="number">1000</span>) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> CustomerId) <span class="keyword">AS</span> N</span><br><span class="line"><span class="keyword">FROM</span> dbo.Customers</span><br><span class="line">)</span><br><span class="line">,</span><br><span class="line">TopCustomer <span class="comment">-- here we define the second CTE here, notice the comma "," above, indicates that the WITH keyword is still effective</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line"> <span class="built_in">MAX</span>(CustomerId) <span class="keyword">AS</span> CustId</span><br><span class="line"><span class="keyword">FROM</span> Number</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> N</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="comment">-- this SELECT is together with the CTE Expression, not separate query</span></span><br><span class="line"> C2.<span class="operator">*</span></span><br><span class="line"><span class="keyword">INTO</span> dbo.CustomersSample </span><br><span class="line"><span class="keyword">FROM</span> TopCustomer <span class="keyword">AS</span> C1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dbo.Customers <span class="keyword">AS</span> C2</span><br><span class="line"> <span class="keyword">ON</span> C1.CustId <span class="operator">=</span> C2.CustomerId</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dbo.CustomersSample <span class="comment">-- with the above cte method, we created a randomized sample in the dbo.customers table</span></span><br></pre></td></tr></table></figure></li>
<li>Functions and procedures<ul>
<li>Procedure Creation and Execution<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> FizzBuzz()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> N <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">    WHILE N <span class="operator">&lt;=</span> <span class="number">100</span> DO</span><br><span class="line">    <span class="keyword">SET</span> N <span class="operator">=</span> N <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> FizzBuzz();</span><br></pre></td></tr></table></figure></li>
<li>Function Creation  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> multi( <span class="comment">-- if function alrea exists, CREATE is changed to ALTER</span></span><br><span class="line">  n <span class="type">INT</span></span><br><span class="line">  , m <span class="type">INT</span></span><br><span class="line">) </span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="type">INT</span>;</span><br><span class="line">  <span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> m <span class="operator">*</span> n;</span><br><span class="line">  <span class="keyword">RETURN</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> your_db_name.multi(<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br></pre></td></tr></table></figure></li>
<li>Check if the function exists  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FUNCTION</span> STATUS <span class="keyword">WHERE</span> db <span class="operator">=</span> <span class="string">'your database name'</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3 id="String-and-numeric-operations-on-values"><a href="#String-and-numeric-operations-on-values" class="headerlink" title="String and numeric operations on values"></a>String and numeric operations on values</h3><p>String operations</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECt</span> </span><br><span class="line">	<span class="built_in">UPPER</span>(email) up</span><br><span class="line">    , <span class="built_in">LOWER</span>(last_name) low</span><br><span class="line">    , CONCAT(first_name, <span class="string">' '</span>, last_name) full_name</span><br><span class="line">    , LENGTH(email) email_len</span><br><span class="line">    , CONCAT_WS(<span class="string">' | '</span>, first_name, last_name) full_name_with_separator</span><br><span class="line">    , <span class="built_in">TRIM</span>(<span class="string">' hello '</span>) <span class="keyword">AS</span> trimmed</span><br><span class="line">    , <span class="keyword">RIGHT</span>(email, <span class="number">3</span>) <span class="keyword">AS</span> right_three </span><br><span class="line">    , LPAD(customer_id, <span class="number">5</span>, <span class="string">'000'</span>) <span class="keyword">AS</span> left_zero_padding</span><br><span class="line">    , FORMAT(address_id, <span class="number">3</span>) <span class="keyword">AS</span> formated_3_float_point</span><br><span class="line"><span class="keyword">FROM</span> customer</span><br><span class="line">LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p>Regex Matching<a target="_blank" rel="noopener" href="https://dataschool.com/how-to-teach-people-sql/how-regex-works-in-sql/">1</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(first_name, <span class="string">' '</span>, last_name) <span class="keyword">FROM</span> customer</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="operator">~</span> <span class="string">'^[^aeiou]'</span> <span class="keyword">AND</span> last_name <span class="operator">~</span><span class="operator">*</span> <span class="string">'[aeiou]$'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">right</span>(first_name, <span class="number">2</span>);</span><br><span class="line"><span class="comment">-- ~ : Case-sensitive, compares two statements, returns true if the first string is contained in the second</span></span><br><span class="line"><span class="comment">-- ~* : Case-insensitive, compares two statements, returns true if the first string is contained in the second</span></span><br><span class="line"><span class="comment">-- !~ : Case-sensitive, compares two statements, returns false if the first string is contained in the second</span></span><br><span class="line"><span class="comment">-- !~* : Case-insensitive, compares two statements, return false if the first string is contained in the second</span></span><br></pre></td></tr></table></figure>
<p>Numeric Functions</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	RAND() <span class="keyword">AS</span> rand_num</span><br><span class="line">    , ROUND(RAND() <span class="operator">*</span> <span class="number">10</span>, <span class="number">2</span>) <span class="keyword">AS</span> rand_round_2_decimal</span><br><span class="line">    , <span class="built_in">CEIL</span>(RAND()) <span class="keyword">AS</span> num_ceil</span><br><span class="line">    , <span class="built_in">FLOOR</span>(RAND()) <span class="keyword">as</span> num_floor</span><br><span class="line">    , RADIANS(<span class="number">180</span>) <span class="keyword">AS</span> pi_from_radian</span><br><span class="line">    , DEGREES(<span class="number">3.141592653589793</span>) <span class="keyword">AS</span> pi_from_degree</span><br><span class="line">    , <span class="built_in">ABS</span>(<span class="number">-3</span>) <span class="keyword">AS</span> absolute_val</span><br><span class="line">    , <span class="built_in">POWER</span>(CUSTOMER_ID, <span class="number">2</span>) <span class="keyword">AS</span> id_square</span><br><span class="line">    , DATEDIFF(shop_date.date, return_date.date) <span class="keyword">AS</span> usage_period</span><br><span class="line">    , CONV(CUSTOMER_ID, <span class="number">10</span>, <span class="number">16</span>) <span class="keyword">AS</span> to_hex</span><br><span class="line">    , IFNULL(potential_NUll_column, <span class="number">0</span>) <span class="keyword">AS</span> replacing_null_with_zero</span><br><span class="line"><span class="keyword">FROM</span> customer</span><br><span class="line">LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- A Blunder</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(amount, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">FROM</span> payment</span><br><span class="line">LIMIT <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Some-Advanced-operations-Window-functions"><a href="#Some-Advanced-operations-Window-functions" class="headerlink" title="Some Advanced operations: Window functions"></a>Some Advanced operations: Window functions</h3><ol>
<li>OVER clause determines window (the set of rows to operate on)</li>
<li>PARTITION BY splits the result set into partitions on which the window function is applied</li>
<li>Functions Available:<ul>
<li>Aggregate - <kbd>COUNT, SUM, MIN, MAX, AVG</kbd></li>
<li>Ranking - <kbd>ROW_NUMBER, RANK, DENSE_RANK, NTILE</kbd></li>
<li>Offset - <kbd>FIRST_VALUE, LAST_VALUE, LEAD, LAG</kbd></li>
<li>Statistical - <kbd>PERCENT_RANK, CUME_DIST, PERCENTILE_CONT, PERCENTILE_DIST</kbd></li>
</ul>
</li>
<li>Windows Functions also have FRAMES<ul>
<li>ROWS</li>
<li>RANGE</li>
</ul>
</li>
</ol>
<h4 id="1-Demo-on-PARTITION-BY"><a href="#1-Demo-on-PARTITION-BY" class="headerlink" title="1. Demo on PARTITION BY"></a>1. Demo on <kbd>PARTITION BY</kbd></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- the non-window function way</span></span><br><span class="line"><span class="keyword">WITH</span> CTE</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , <span class="built_in">SUM</span>(Line_Total) <span class="keyword">AS</span> Total</span><br><span class="line"><span class="keyword">FROM</span> Sales_Details</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Sales_Id</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> CTE <span class="keyword">AS</span> A</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Sales_Details <span class="keyword">AS</span> B</span><br><span class="line">  <span class="keyword">ON</span> A.Sales_Id <span class="operator">=</span> B.Sales_Id;	</span><br><span class="line">  </span><br><span class="line"><span class="comment">-- the window function way</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , Sales_Date</span><br><span class="line">  , Item</span><br><span class="line">  , Price</span><br><span class="line">  , Quantity</span><br><span class="line">  , Line_Total</span><br><span class="line">  , <span class="built_in">COUNT</span>(Line_Total) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Id) <span class="keyword">AS</span> Line_Count</span><br><span class="line">  , <span class="built_in">SUM</span>(Line_Total) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Id) <span class="keyword">AS</span> Sales_Total</span><br><span class="line">  , <span class="built_in">SUM</span>(Line_Total) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Date) <span class="keyword">AS</span> Daily_Total</span><br><span class="line">  , <span class="built_in">SUM</span>(Line_Total) <span class="keyword">OVER</span>() <span class="keyword">AS</span> Total</span><br><span class="line"><span class="keyword">FROM</span> Sales_Details</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total;</span><br></pre></td></tr></table></figure>

<h4 id="2-On-Ranking-Functions"><a href="#2-On-Ranking-Functions" class="headerlink" title="2. On Ranking Functions"></a>2. On Ranking Functions</h4><p>Ranking functions are available as part of Window Functions:</p>
<ul>
<li><p><kbd>ROW_NUMBER()</kbd> unique incrementing integers</p>
</li>
<li><p><kbd>RANK()</kbd> same rank for same values, but keep the counting rolling <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="4.964ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 2194 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(278,0)"><path data-c="27F9" d="M1218 514Q1218 525 1234 525Q1239 525 1242 525T1247 525T1251 524T1253 523T1255 520T1257 517T1260 512Q1297 438 1358 381T1469 300T1565 263Q1582 258 1582 250T1573 239T1536 228T1478 204Q1334 134 1260 -12Q1256 -21 1253 -22T1238 -24Q1218 -24 1218 -17Q1218 -13 1223 0Q1258 69 1309 123L1319 133H70Q56 140 56 153Q56 168 72 173H1363L1373 181Q1412 211 1490 250Q1489 251 1472 259T1427 283T1373 319L1363 327H710L707 328L390 327H72Q56 332 56 347Q56 360 70 367H1319L1309 377Q1276 412 1247 458T1218 514Z"></path></g><g data-mml-node="mstyle" transform="translate(1916,0)"><g data-mml-node="mspace"></g></g></g></g></svg></mjx-container> 1, 1 (duplicate), 3, 4, 5</p>
</li>
<li><p><kbd>DENSE_RANK()</kbd>: same rank for same values, but only increase rank by 1 when values change <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.054ex;" xmlns="http://www.w3.org/2000/svg" width="4.964ex" height="1.242ex" role="img" focusable="false" viewBox="0 -525 2194 549"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mstyle"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(278,0)"><path data-c="27F9" d="M1218 514Q1218 525 1234 525Q1239 525 1242 525T1247 525T1251 524T1253 523T1255 520T1257 517T1260 512Q1297 438 1358 381T1469 300T1565 263Q1582 258 1582 250T1573 239T1536 228T1478 204Q1334 134 1260 -12Q1256 -21 1253 -22T1238 -24Q1218 -24 1218 -17Q1218 -13 1223 0Q1258 69 1309 123L1319 133H70Q56 140 56 153Q56 168 72 173H1363L1373 181Q1412 211 1490 250Q1489 251 1472 259T1427 283T1373 319L1363 327H710L707 328L390 327H72Q56 332 56 347Q56 360 70 367H1319L1309 377Q1276 412 1247 458T1218 514Z"></path></g><g data-mml-node="mstyle" transform="translate(1916,0)"><g data-mml-node="mspace"></g></g></g></g></svg></mjx-container> 1, 1 (duplicate), 2, 3, 4</p>
</li>
<li><p><kbd>RANK()</kbd> vs <kbd>DENSE_RANK()</kbd>: <kbd>RANK()</kbd> will have rows with identical rank/ gaps in rank if we get tied values</p>
</li>
<li><p><kbd>NTILE(N)</kbd> assigns tile number based on the number of tiles required, just assign each row with a value from 0 - N ,in increase order</p>
<ul>
<li>Example: 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, …. ,N, N, N, N</li>
<li>Usage: for partitioning/selective sampling of the data</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>   <span class="comment">-- note that here we use ORDER BY instead of PARTITION BY because order/rank is sort of important rather than the fixed set of value</span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , Sales_Total</span><br><span class="line">  , <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> rownum </span><br><span class="line">  , <span class="built_in">RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> rnk</span><br><span class="line">  , <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> dense</span><br><span class="line">  , <span class="built_in">NTILE</span>(<span class="number">3</span>) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> ntle</span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales_2</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>   <span class="comment">-- This is the modified way, we rank individual set of rows by adding on the PARTITION BY </span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , Sales_Cust_Id</span><br><span class="line">  , Sales_Total</span><br><span class="line">  , <span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Cust_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> rownum </span><br><span class="line">  , <span class="built_in">RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Cust_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> rnk</span><br><span class="line">  , <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Cust_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> dense</span><br><span class="line">  , <span class="built_in">NTILE</span>(<span class="number">3</span>) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Cust_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Total <span class="keyword">DESC</span>) <span class="keyword">AS</span> ntle</span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales_2</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Cust_Id</span><br></pre></td></tr></table></figure>

<h4 id="3-GROUP-BY"><a href="#3-GROUP-BY" class="headerlink" title="3. GROUP BY"></a>3. <kbd>GROUP BY</kbd></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Cust_Id</span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">AS</span> Total</span><br><span class="line">  , <span class="built_in">RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">DESC</span>) <span class="keyword">AS</span> rnk <span class="comment">-- note that we used SUM(Sales_Total) not Sales_Total or Total because we need the order of SUM(Sales_Total) for each customer and Total is not defined well</span></span><br><span class="line">  , <span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">DESC</span>) <span class="keyword">AS</span> dnse</span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales_2</span><br><span class="line"><span class="keyword">WHERE</span> Sales_Date <span class="operator">&gt;=</span> <span class="string">'2019-03-01'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Sales_Cust_Id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> rnk</span><br><span class="line"></span><br><span class="line"><span class="comment">-- special OVER clause operation</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Customer_Id</span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Amount) <span class="keyword">AS</span> Cust_Total</span><br><span class="line">  , <span class="built_in">SUM</span>(<span class="built_in">SUM</span>(Sales_Amount)) <span class="comment">-- this declaration will be wrong as the system says cannot aggregate over another aggregation</span></span><br><span class="line">  , <span class="built_in">SUM</span>(<span class="built_in">SUM</span>(Sales_Amount)) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> (<span class="keyword">SELECT</span> <span class="keyword">NULL</span>)) <span class="keyword">AS</span> Grand_Total <span class="comment">-- this is the proper way as the aggregation is down to the OVER Clause not the SUM(Sales_Amount) function</span></span><br><span class="line">  , <span class="built_in">AVG</span>(<span class="built_in">SUM</span>(Sales_Amount)) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> (<span class="keyword">SELECT</span> <span class="keyword">NULL</span>)) <span class="keyword">AS</span> Average_Cust_Total</span><br><span class="line">  , <span class="built_in">CAST</span>((<span class="built_in">SUM</span>(Sales_Amount) <span class="operator">/</span> <span class="built_in">SUM</span>(<span class="built_in">SUM</span>(Sales_Amount)) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> (<span class="keyword">SELECT</span> <span class="keyword">NULL</span>))) <span class="operator">*</span> <span class="number">100</span> <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">6</span>,<span class="number">2</span>)) <span class="keyword">AS</span> Pct</span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Sales_Customer_Id</span><br></pre></td></tr></table></figure>
<h4 id="4-Window-FRAMES"><a href="#4-Window-FRAMES" class="headerlink" title="4. Window FRAMES"></a>4. Window FRAMES</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , Sales_Date</span><br><span class="line">  , Sales_Total</span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> UNBOUNDED PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) <span class="keyword">AS</span> [<span class="keyword">Running</span> Total]</span><br><span class="line">  <span class="comment">-- note that SUM is a window function here</span></span><br><span class="line">  <span class="comment">-- ROWS BETWEEN ... AND CURRENT ROW gives FRAME that is the set of rows from UNBOUNDED PRECEDING to this CUR ROW</span></span><br><span class="line">  <span class="comment">-- [Runnig Total] =&gt; need to put [] between a phrase with empty space " "</span></span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> k PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) <span class="keyword">AS</span> [<span class="keyword">Running</span> Total]</span><br><span class="line">  <span class="comment">-- this line has the FRAME only between the CURRENT ROW and the k rows before it; </span></span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date <span class="keyword">ROWS</span> UNBOUNDED PRECEDING) <span class="keyword">AS</span> [<span class="keyword">Running</span> Total]</span><br><span class="line">  <span class="comment">-- this line is a simplified version for BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</span></span><br><span class="line">  , </span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales_2</span><br><span class="line"><span class="keyword">WHERE</span> Sales_Cust_Id <span class="operator">=</span> <span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  Sales_Id</span><br><span class="line">  , Sales_Date</span><br><span class="line">  , Sales_Total</span><br><span class="line">  , <span class="built_in">SUM</span>(Sales_Total) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date <span class="keyword">ROWS</span> UNBOUNDED PRECEDING) <span class="keyword">AS</span> [<span class="keyword">Running</span> Total]</span><br><span class="line">  , <span class="built_in">CAST</span>(<span class="built_in">AVG</span>(Sales_Total) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Cust_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date <span class="keyword">ROWS</span> UNBOUNDED PRECEDING) <span class="keyword">AS</span> <span class="type">DECIMAL</span>(<span class="number">8</span>, <span class="number">2</span>)) <span class="keyword">AS</span> [<span class="keyword">Running</span> Average]</span><br><span class="line">  <span class="comment">-- this line enables running average for individual customers for all of them</span></span><br><span class="line">  <span class="comment">-- CAST .. AS DECIMAL(8,2) reduces the resultant running average into 2 decimal points</span></span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales_2</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date</span><br></pre></td></tr></table></figure>
<h4 id="5-Lag-and-Lead"><a href="#5-Lag-and-Lead" class="headerlink" title="5. Lag and Lead"></a>5. Lag and Lead</h4><ul>
<li>Useful for trend analysis</li>
<li><kbd>LAG</kbd> - return the value from the previous row</li>
<li><kbd>LEAD</kbd> - return the value from the next row</li>
<li>Format: <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">LAG</span>([<span class="keyword">Column</span>], [<span class="keyword">Offset</span>], [<span class="keyword">Value</span> if <span class="keyword">NULL</span>])</span><br></pre></td></tr></table></figure></li>
<li>Demo:<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  Sales_Customer_Id</span><br><span class="line">  , Sales_Date</span><br><span class="line">  , <span class="built_in">LAG</span>(Sales_Amount, <span class="number">2</span>, <span class="number">0</span>) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Customer_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date) <span class="keyword">AS</span> PrevValue</span><br><span class="line">  <span class="comment">-- get the Sales_Amount 2 days before, if no value is in the entry 2 days before, set it to 0 (default is NULL)</span></span><br><span class="line">  , Sales_Amount</span><br><span class="line">  , <span class="built_in">LEAD</span>(Sales_Amount, <span class="number">2</span>, <span class="number">0</span>) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Sales_Customer_Id <span class="keyword">ORDER</span> <span class="keyword">BY</span> Sales_Date) <span class="keyword">AS</span> NextValue</span><br><span class="line">  <span class="comment">-- idea is the same, just change it to later</span></span><br><span class="line"><span class="keyword">FROM</span> dbo.Sales</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6-Rolling-window"><a href="#6-Rolling-window" class="headerlink" title="6. Rolling window"></a>6. Rolling window</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  <span class="operator">*</span></span><br><span class="line">  , <span class="built_in">SUM</span>(SalesAmount) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> [<span class="type">Date</span>] <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> <span class="number">9</span> PRECEDING <span class="keyword">AND</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span>) <span class="keyword">AS</span> Total </span><br><span class="line">  <span class="comment">-- the Window FRAME method and SUM function together makings the window "rolling"</span></span><br><span class="line">  , <span class="built_in">SUM</span>(SalesAmount) <span class="keyword">OVER</span>(<span class="keyword">ORDER</span> <span class="keyword">BY</span> [<span class="type">Date</span>] <span class="keyword">ROWS</span> <span class="keyword">BETWEEN</span> <span class="keyword">CURRENT</span> <span class="type">ROW</span> <span class="keyword">AND</span> <span class="number">9</span> FOLLOWING) <span class="keyword">AS</span> Forward</span><br><span class="line">  <span class="comment">-- we use FOLLOWING for the future rows</span></span><br><span class="line"><span class="keyword">FROM</span> #TempSales <span class="comment">-- nothing fancy about # sign here</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> [<span class="type">Date</span>] <span class="comment">-- here [] is needed because Date itself is a SQL keyword</span></span><br></pre></td></tr></table></figure>

<h4 id="7-Variable-Specification"><a href="#7-Variable-Specification" class="headerlink" title="7. Variable Specification"></a>7. Variable Specification</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> some_global_variable <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@n</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@n</span> <span class="keyword">AS</span> num;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span><span class="variable">@id</span> <span class="operator">=</span> (<span class="keyword">SELECT</span> payment_id <span class="keyword">FROM</span> payment <span class="keyword">WHERE</span> customer_id <span class="operator">=</span> <span class="number">2</span> LIMIT <span class="number">1</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@id</span> <span class="keyword">AS</span> new_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> cte <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> customer_id, <span class="built_in">COUNT</span>(payment_id) cc</span><br><span class="line"><span class="keyword">FROM</span> payment p</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_id</span><br><span class="line">),</span><br><span class="line">cnt <span class="keyword">AS</span> (<span class="keyword">SELECT</span> cc, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> tcc, <span class="built_in">MAX</span>(cc) <span class="keyword">OVER</span>() <span class="keyword">AS</span> mcc <span class="keyword">FROM</span> cte <span class="keyword">GROUP</span> <span class="keyword">BY</span> cc)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> cte</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> cnt <span class="keyword">ON</span> cnt.cc <span class="operator">=</span> cte.cc <span class="keyword">AND</span> (cnt.tcc <span class="operator">=</span> <span class="number">1</span> <span class="keyword">OR</span> cnt.cc <span class="operator">=</span> cnt.mcc)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cte.cc <span class="keyword">DESC</span>, customer_id <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>The above codes demonstrate the majorities of the SQL codes formats an engineer would ever need in its daily CRUD operations already. Thanks for reading!</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>SQL: Pick up the Basic within a day</p><p><a href="https://criss-wang.github.io/post/blogs/sql-1/">https://criss-wang.github.io/post/blogs/sql-1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Zhenlin Wang</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-08-15</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-05-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Database-System/">Database System, </a><a class="link-muted" rel="tag" href="/tags/SQL/">SQL </a></div></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/post/blogs/sql-2/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">SQL: Index and Optimization</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/post/blogs/database-introduction/"><span class="level-item">Database: Intro</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Selfie.webp" alt="Zhenlin Wang (Criss)"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Zhenlin Wang (Criss)</p><div class="is-size-7 multiline is-block justify-content-center" style="white-space:pre;font-style: italic">Software Development
Machine Learning
Artificial Intelligence
</div><div style="padding-top: 10px;"></div><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Pittsburgh, PA</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">50</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">40</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Criss-Wang/" target="_blank" rel="noopener"><i class="fab fa-github"></i>   Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Criss-Wang/"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/zhenlin-wang/"><i class="fab fa-linkedin-in"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:zhenlinw@cs.cmu.edu"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CV" href="https://criss-wang.github.io/pdf/CV_Wang_Zhenlin.pdf"><i class="fas fa-fw fa-link"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Anime/"><span class="level-start"><span class="level-item">Anime</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Blogs/"><span class="level-start"><span class="level-item">Blogs</span></span><span class="level-end"><span class="level-item tag">45</span></span></a></li><li><a class="level is-mobile" href="/categories/Enlightenment/"><span class="level-start"><span class="level-item">Enlightenment</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Projects/"><span class="level-start"><span class="level-item">Projects</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Data-Mining-Data-Engineering/"><span class="tag">Data Mining/Data Engineering</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unsupervised-Learning/"><span class="tag">Unsupervised Learning</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Clustering/"><span class="tag">Clustering</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Supervised-Learning/"><span class="tag">Supervised Learning</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reinforcement-Learning/"><span class="tag">Reinforcement Learning</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Database-System/"><span class="tag">Database System</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Optimization/"><span class="tag">Optimization</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistics/"><span class="tag">Statistics</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Big-Data/"><span class="tag">Big Data</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Recommender-Systems/"><span class="tag">Recommender Systems</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL/"><span class="tag">SQL</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Software-Engineering/"><span class="tag">Software Engineering</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Analytics/"><span class="tag">Data Analytics</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Boosting/"><span class="tag">Boosting</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep Learning</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/A-B-testing/"><span class="tag">A/B testing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Distributed-System/"><span class="tag">Distributed System</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cloud-Computing/"><span class="tag">Cloud Computing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Matrix-Computation/"><span class="tag">Matrix Computation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dimensionality-Reduction/"><span class="tag">Dimensionality Reduction</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ensemble/"><span class="tag">Ensemble</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bagging/"><span class="tag">Bagging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Random-Forest/"><span class="tag">Random Forest</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hidden-Markov-Models/"><span class="tag">Hidden Markov Models</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dynamic-Programming/"><span class="tag">Dynamic Programming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/icarus/"><span class="tag">icarus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/front-end/"><span class="tag">front-end</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog-building/"><span class="tag">blog-building</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linear-Algebra/"><span class="tag">Linear Algebra</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-learning/"><span class="tag">Deep learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regularization/"><span class="tag">Regularization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Control-Theory/"><span class="tag">Control Theory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Evaluation-Methods/"><span class="tag">Evaluation Methods</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistical-Inference/"><span class="tag">Statistical Inference</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Representaiton-Learning/"><span class="tag">Representaiton Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bayesian-Statistics/"><span class="tag">Bayesian Statistics</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Overview"><span class="level-left"><span class="level-item">1</span><span class="level-item">Overview</span></span></a></li><li><a class="level is-mobile" href="#Basic-Concepts"><span class="level-left"><span class="level-item">2</span><span class="level-item">Basic Concepts</span></span></a></li><li><a class="level is-mobile" href="#Basic-Operations"><span class="level-left"><span class="level-item">3</span><span class="level-item">Basic Operations</span></span></a></li><li><a class="level is-mobile" href="#String-and-numeric-operations-on-values"><span class="level-left"><span class="level-item">4</span><span class="level-item">String and numeric operations on values</span></span></a></li><li><a class="level is-mobile" href="#Some-Advanced-operations-Window-functions"><span class="level-left"><span class="level-item">5</span><span class="level-item">Some Advanced operations: Window functions</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-Demo-on-PARTITION-BY"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">1. Demo on PARTITION BY</span></span></a></li><li><a class="level is-mobile" href="#2-On-Ranking-Functions"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">2. On Ranking Functions</span></span></a></li><li><a class="level is-mobile" href="#3-GROUP-BY"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">3. GROUP BY</span></span></a></li><li><a class="level is-mobile" href="#4-Window-FRAMES"><span class="level-left"><span class="level-item">5.4</span><span class="level-item">4. Window FRAMES</span></span></a></li><li><a class="level is-mobile" href="#5-Lag-and-Lead"><span class="level-left"><span class="level-item">5.5</span><span class="level-item">5. Lag and Lead</span></span></a></li><li><a class="level is-mobile" href="#6-Rolling-window"><span class="level-left"><span class="level-item">5.6</span><span class="level-item">6. Rolling window</span></span></a></li><li><a class="level is-mobile" href="#7-Variable-Specification"><span class="level-left"><span class="level-item">5.7</span><span class="level-item">7. Variable Specification</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">6</span><span class="level-item">Conclusion</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.staticaly.com/gh/Criss-Wang/image-host@master/Blog/Steins_Gate_Lab_Badge.webp" alt="Criss Wang&#039;s Log Book" height="28"></a><p class="is-size-7"><span>&copy; 2022 Zhenlin Wang</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="/js/night.js" defer></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>